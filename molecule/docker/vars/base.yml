---
homedir: ''

# Config cfr https://github.com/IBM-Security/verify-access-container-deployment
policyserver_runtime:
  configuration:
    ps_mode: local
    admin_pwd: Passw0rd
    user_registry: ldap
    ldap_dn: cn=root,secAuthority=Default
    ldap_pwd: Passw0rd
    ldap_host: openldap
    ldap_port: '636'
    ldap_suffix: ''
    admin_cert_lifetime: '1460'
    domain: Default
    ldap_ssl_db: embedded_ldap_keys
    ldap_ssl_label: ''
    isam_host: "127.0.0.1"
    isam_port: "7135"
    ssl_compliance: fips

base_admin_cfg:
  enableSSLv3: True
  maxFiles: 50
  maxFileSize:
  loginHeader: "{{ inventory_hostname }} - molecule"
  loginMessage: "{{ inventory_hostname }} - molecule message"
  lmiMessageTimeout:
  validVerifyDomains:
  jsVersion: ""

personal_certificates:
  # get all certificates from keystore
  - cert_action: get_all
    kdb_id: pdsrv
  # get content of a specific certificate from keystore
  - cert_action: get
    kdb_id: pdsrv
    cert_id: WebSEAL-Test-Only
  # Generating a self-signed personal certificate in a certificate database
  - cert_action: generate
    kdb_id: pdsrv
    label: sample_label
    dn: 'CN=weblinux.Raleigh.ibm.com,O=ibm,OU=IBMHTTP Server,L=RTP,ST=NC,C=US'
    expire: '365' # optional default: '365'
    # default: 'no' # optional default: 'no'  No longer valid
    size: '2048' # optional default: '1024' OPTIONS: on SHA***WithRSA['1024','2048','4096'] on SHA***WithECDSA['256','384','512']
    signature_algorithm: 'SHA512WithRSA' # optional default: '' if empty will get SHA1WithRSASignature
          # OPTIONS: ['SHA256WithRSA','SHA384WithRSA','SHA512WithRSA','SHA256WithECDSA','SHA384WithECDSA','SHA512WithECDSA']
  # Setting a personal certificate as default in a certificate database
  # Receiving a personal certificate into a certificate database TODO
  #- cert_action: receive
  #  kdb_id: pdsrv
  #  label: sample_label
  #  cert: files/ssl/runtime.csr # absolute or relative path supported
  # Exporting a personal certificate from a certificate database TODO
  #- cert_action: export_cert
  #  kdb_id: pdsrv
  #  cert_id: sample_label
  #  filename: files/ssl/sample.cert # absolute or relative path supported
  # Importing a personal certificate into a certificate database TODO
  - cert_action: import_cert
    kdb_id: pdsrv
    label: test_certificate
    cert: files/test_certificate.p12
    password: 'passw0rd'
  - cert_action: import_cert
    kdb_id: rt_profile_keys
    label: test_certificate
    cert: "{{ playbook_dir }}/files/test_certificate.p12"
    password: 'passw0rd'
  # Importing a personal certificate into a certificate database TODO
  #- cert_action: extract_cert
  #  kdb_id: pdsrv
  #  cert_id: sample_label
  #  filename: files/ssl/sample.cert # absolute or relative path supported
  #  password: 'passw0rd'
  # Deleting a personal certificate from a certificate database
  - cert_action: delete
    kdb_id: rt_profile_keys
    cert_id: test_certificate
  - cert_action: rename
    kdb_id: pdsrv
    cert_id: sample_label
    new_id: renamed_sample_label

signer_certificates:
  # import multiple signer certificates
  # Openldap (docker)
  - cert_action: import_cert
    kdb_id: rt_profile_keys
    cert: >-
           -----BEGIN CERTIFICATE-----
           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
           -----END CERTIFICATE-----
    label: github.io
    preserve_label: false
  - cert_action: import_cert
    kdb_id: embedded_ldap_keys
    cert: "{{ lookup('ansible.builtin.file', '~/dockershare/composekeys/openldap/ldap.crt', rstrip=False)  }}"
    label: openldap
    preserve_label: false
  - cert_action: import_cert
    kdb_id: pdsrv
    cert:  "{{ lookup('ansible.builtin.file', '~/dockershare/composekeys/openldap/ca.crt', rstrip=False)  }}"
    label: openldap_ca
    preserve_label: false
  - cert_action: import_cert
    kdb_id: pdsrv
    cert: >-
      -----BEGIN CERTIFICATE-----
      MIIDpTCCA0qgAwIBAgIRAP43bd3jsmBgETiUqdBOetcwCgYIKoZIzj0EAwIwOzEL
      MAkGA1UEBhMCVVMxHjAcBgNVBAoTFUdvb2dsZSBUcnVzdCBTZXJ2aWNlczEMMAoG
      A1UEAxMDV0UxMB4XDTI1MDgyODA0NDc1NVoXDTI1MTEyNjA1NDc0NVowFjEUMBIG
      A1UEAxMLYW5zaWJsZS5jb20wWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARZkutS
      sFbOrPqnEXlL34ijJbKJZiG/fr1B1po6TMo/YcwKNN3twwbRp+m2bWR/xByM0GQ8
      iGCSY1YZ8dSysVXgo4ICUjCCAk4wDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoG
      CCsGAQUFBwMBMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFPvdd22yi3wOVIrrqdo/
      AuO75IaRMB8GA1UdIwQYMBaAFJB3kjVnxP+ozKnme9mAeXvMk/k4MF4GCCsGAQUF
      BwEBBFIwUDAnBggrBgEFBQcwAYYbaHR0cDovL28ucGtpLmdvb2cvcy93ZTEvX2pj
      MCUGCCsGAQUFBzAChhlodHRwOi8vaS5wa2kuZ29vZy93ZTEuY3J0MCUGA1UdEQQe
      MByCC2Fuc2libGUuY29tgg0qLmFuc2libGUuY29tMBMGA1UdIAQMMAowCAYGZ4EM
      AQIBMDYGA1UdHwQvMC0wK6ApoCeGJWh0dHA6Ly9jLnBraS5nb29nL3dlMS9mSmVk
      bUwycGV0by5jcmwwggEDBgorBgEEAdZ5AgQCBIH0BIHxAO8AdgDM+w9qhXEJZf6V
      m1PO6bJ8IumFXA2XjbapflTA/kwNsAAAAZjvN+1bAAAEAwBHMEUCIQCuUEnwuFN4
      PRDk5vMsCbD/WklJqPgXBOE4NpliBrQqfwIgKOiHWEhzolvWnbGNlrjLsfGIOaz+
      si9gFhwnBaWXvdoAdQAS8U40vVNyTIQGGcOPP3oT+Oe1YoeInG0wBYTr5YYmOgAA
      AZjvN+0iAAAEAwBGMEQCIFhQdWKpTlysGzMRyu4s5//YO/jaY6SyTBsR+goAUaLd
      AiBE+Y2qZSahei9nIpjPqkdrgwFZjVGeXER4h/OPrjcPGDAKBggqhkjOPQQDAgNJ
      ADBGAiEAldO8MmATNBe89GvfkSmxFn1ERu4SKeRPxft+vkED6vUCIQD/F/DmfWdV
      xqnNFhu16mUDQxQRqAZgQkBUDjCBOGQQ2A==
      -----END CERTIFICATE-----
    label: imported.ansible.com
  # get all certificates from keystore
  - cert_action: get_all
    kdb_id: pdsrv

base_audit_type_id: runtime
base_audit_group_name: FIDO2

base_audit_component_id: '1'

advanced_tuning_parameters:
  - key: events.response.snmp.ignored
    value: GLGUP(.*) GLGSI(.*) GLGSS(.*) GLGFP(.*) GLGEV(.*) GLGDT(.*) GLGLI(.*) GLG(.*)I FBTSML241E GLGSY0101W
    comment: ignore some events
  - key: sysctl.net.ipv6.conf.all.disable_ipv6
    value: "1"
    tuning_action: set

runtime_tunings:
  - runtime_action: set
    option: max_files
    value: 40
  - runtime_action: set
    option: max_file_size
    value: 100
  - runtime_action: reset
    option: max_files

docker_db_config:
   hvdb_db_type: postgresql
   hvdb_address: "postgresql"
   hvdb_port:  "5432"
   hvdb_user: "postgres"
   hvdb_password: "Passw0rd"
   hvdb_db_name: "ivia"
   hvdb_db_secure: false
#  #optional
#  hvdb_driver_type:
#  hvdb_db2_alt_address:
#  hvdb_db2_alt_port:
#  hvdb_solid_tc:
   ignore_password_for_idempotency: true
